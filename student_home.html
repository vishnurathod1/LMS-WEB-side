<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Home</title>
    <link rel="stylesheet" href="student_home.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <nav class="navbar">
        <div class="navbar-container">
            <a href="home.html" class="navbar-brand">ðŸ“š LMS Project</a>
            <div class="search-bar">
                <input type="text" placeholder="Search courses..." class="search-input">
                <button class="search-btn"><i class="fas fa-search"></i></button>
            </div>
            <ul class="navbar-menu">
                <li class="navbar-item"><a href="home.html" class="navbar-link"><i class="fas fa-home"></i> Home</a></li>
                <li class="navbar-item"><a href="student_home.html" class="navbar-link"><i class="fas fa-graduation-cap"></i> Student Home</a></li>
                <li class="navbar-item"><a href="login.html" class="navbar-link"><i class="fas fa-sign-out-alt"></i> Logout</a></li>
            </ul>
        </div>
    </nav>
    <div class="class">
        <h1>Welcome, Student!</h1>
        <p>You have access to your courses and learning materials.</p>
        <br>
        <ul class="student1">
            <li class="Rathod"><a href="courses_list.html" class="vishnu"> View Courses</a></li>
            <li class="Rathod"><a href="unenroll.html" class="vishnu"> Unenroll Courses</a></li>
            <li class="Rathod"><a href="live_class.html" class="vishnu"> Live Lecturer</a></li>
            <li class="Rathod"><a href="recorded_leacture_class.html" class="vishnu"> Recorded Lecturer</a></li>
            <li class="Rathod"><a href="student_assignments.html" class="vishnu" >Assignments</a></li>
            <li class="Rathod"><a href="student_attendance.html" class="vishnu"> Attendance</a></li>
            <li class="Rathod"><a href="student_grades.html" class="vishnu"> Grades</a></li>
            <li class="Rathod"><a href="view_report.html" class="vishnu"> View Reports</a></li>
            <li class="Rathod"><a href="performance_metrics.html" class="vishnu"> Performance Metrics</a></li>
            <li class="Rathod"><a href="student_compliance.html" class="vishnu"> Compliance</a></li>
            <li class="Rathod"><a href="student_system_updates.html" class="vishnu"> System Updates</a></li>
            <a href="login.html" class="buttanlog"> Logout</a>
        </ul>

        <h2>Student Attendance</h2>
        <div id="studentAttendance">
            <!-- Attendance records will be displayed here -->
        </div>

        <!-- Trainer Videos Section -->
        <h2><i class="fas fa-video"></i> Videos from Trainers</h2>
        <div id="trainer-videos-container" class="trainer-videos-section">
            <!-- Trainer videos will be dynamically added here -->
        </div>

        <!-- <h2>Recorded Classes</h2>
        <div class="recorded-classes-list">
            <!-- Recorded classes will be dynamically added here -->
        <!-- </div> --> -->
    </div>

    <script>
        function loadStudentAttendance() {
            const attendance = JSON.parse(localStorage.getItem('attendance')) || [];
            const studentAttendance = attendance.filter(record => record.userType === 'student');
            const container = document.getElementById('studentAttendance');

            if (studentAttendance.length === 0) {
                container.innerHTML = '<p>No attendance records found.</p>';
                return;
            }

            let html = '<table><thead><tr><th>User Name</th><th>Date</th><th>Status</th></tr></thead><tbody>';
            studentAttendance.forEach(record => {
                html += `<tr><td>${record.userName}</td><td>${record.date}</td><td>${record.status}</td></tr>`;
            });
            html += '</tbody></table>';
            container.innerHTML = html;
        }

        loadStudentAttendance();

        // Load and display trainer videos
        function loadTrainerVideos() {
            const trainerVideos = JSON.parse(localStorage.getItem('trainerVideos')) || [];
            const container = document.getElementById('trainer-videos-container');

            if (trainerVideos.length === 0) {
                container.innerHTML = '<p class="no-videos">No videos available from trainers yet. Check back later!</p>';
                return;
            }

            // Filter only active videos
            const activeVideos = trainerVideos.filter(video => video.status === 'Active');

            if (activeVideos.length === 0) {
                container.innerHTML = '<p class="no-videos">No active videos available from trainers.</p>';
                return;
            }

            let html = '';
            activeVideos.forEach((video, index) => {
                const uploadDate = new Date(video.uploadDate).toLocaleDateString();
                html += `
                    <div class="trainer-video-item" data-video-id="${index}">
                        <div class="video-header">
                            <h3 class="video-title">${video.title}</h3>
                            <span class="video-status status-${video.status.toLowerCase()}">${video.status}</span>
                        </div>
                        <p class="video-description">${video.description}</p>
                        <div class="video-meta">
                            <span class="video-course"><i class="fas fa-book"></i> ${video.course}</span>
                            <span class="video-trainer"><i class="fas fa-user"></i> ${video.trainer}</span>
                            <span class="video-date"><i class="fas fa-calendar"></i> ${uploadDate}</span>
                        </div>
                        <div class="video-player-container">
                            <video controls class="trainer-video-player" preload="metadata">
                                <source src="${video.videoUrl}" type="video/mp4">
                                <source src="${video.videoUrl}" type="video/webm">
                                <source src="${video.videoUrl}" type="video/ogg">
                                Your browser does not support the video tag.
                            </video>
                        </div>
                        <div class="video-actions">
                            <button class="btn-play" onclick="playVideo(${index})">
                                <i class="fas fa-play"></i> Play
                            </button>
                            <button class="btn-download" onclick="downloadVideo('${video.fileName}', '${video.videoUrl}')">
                                <i class="fas fa-download"></i> Download
                            </button>
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        // Play video function
        function playVideo(videoIndex) {
            const videoItems = document.querySelectorAll('.trainer-video-item');
            const targetVideo = videoItems[videoIndex].querySelector('.trainer-video-player');
            if (targetVideo) {
                targetVideo.play();
            }
        }

        // Download video function
        function downloadVideo(fileName, videoUrl) {
            const link = document.createElement('a');
            link.href = videoUrl;
            link.download = fileName || 'trainer-video.mp4';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Load trainer videos when page loads
        document.addEventListener('DOMContentLoaded', function() {
            loadTrainerVideos();

            // Refresh videos every 30 seconds to check for new uploads
            setInterval(loadTrainerVideos, 30000);
        });
    </script>
    <!-- <script>
        function getRecordedClasses() {
            const recordedClasses = localStorage.getItem('recordedClasses');
            return recordedClasses ? JSON.parse(recordedClasses) : [];
        }

        function renderRecordedClasses() {
            const recordedClasses = getRecordedClasses();
            const container = document.querySelector('.recorded-classes-list');
            container.innerHTML = '';

            if (recordedClasses.length === 0) {
                container.innerHTML = '<p>No recorded classes available.</p>';
                return;
            }

            recordedClasses.forEach((recordedClass) => {
                console.log("Rendering video URL:", recordedClass.videoUrl);
                const div = document.createElement('div');
                div.classList.add('recorded-class-item');
                div.innerHTML = `
                    <h3>${recordedClass.title}</h3>
                    <p>${recordedClass.description}</p>
                    <p><strong>Course:</strong> ${recordedClass.course}</p>
                    <p><strong>Trainer:</strong> ${recordedClass.trainer}</p>
                    <video controls width="600" src="${recordedClass.videoUrl}"></video>
                    <p><strong>Status:</strong> ${recordedClass.status}</p>
                `;
                container.appendChild(div);
            });
        } -->

        
</body>
</html>