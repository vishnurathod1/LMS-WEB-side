<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Add Recorded Class</title>
    <link rel="stylesheet" href="trainer_styles.css" />
    <link rel="stylesheet" href="add_recorded_class.css" />
</head>
<style>
    .trainer-container{
        width: 600px;
        border: 3px solid black;
    }
</style>
<body>
    <div class="trainer-container">
        <h1>Add New Recorded Class</h1>
        <form id="add-recorded-class-form">
            <label for="title">Recorded Class Title:</label>
            <input type="text" id="title" name="title" required /><br /><br />

            <label for="description">Description:</label>
            <textarea id="description" name="description" required></textarea><br /><br />

            <label for="lecturer">Lecturer:</label>
            <input type="text" id="lecturer" name="lecturer" required /><br /><br />

            <label for="videoSrc">Video Source URL:</label>
            <input type="url" id="videoSrc" name="videoSrc" placeholder="Enter video URL (optional if uploading file)" /><br /><br />

            <label for="videoFile">Or Upload Video File:</label>
            <input type="file" id="videoFile" name="videoFile" accept="video/*" /><br /><br />

            <div id="file-info" style="display: none; margin-top: 10px; padding: 10px; background: #f0f0f0; border-radius: 5px;">
                <small id="file-name"></small><br>
                <small id="file-size"></small>
            </div>

            <button type="submit">Add Recorded Class</button>
        </form>
        <a href="trainer_home.html" class="back-link">Back to Trainer Home</a>
    </div>
    <script>
        // File input handling
        document.getElementById('videoFile').addEventListener('change', function(e) {
            const file = e.target.files[0];
            const fileInfo = document.getElementById('file-info');
            const fileName = document.getElementById('file-name');
            const fileSize = document.getElementById('file-size');

            if (file) {
                fileName.textContent = 'File: ' + file.name;
                fileSize.textContent = 'Size: ' + (file.size / 1024 / 1024).toFixed(2) + ' MB';
                fileInfo.style.display = 'block';

                // Clear URL field when file is selected
                document.getElementById('videoSrc').value = '';
            } else {
                fileInfo.style.display = 'none';
            }
        });

        // URL input handling
        document.getElementById('videoSrc').addEventListener('input', function(e) {
            if (e.target.value.trim() !== '') {
                // Clear file input when URL is entered
                document.getElementById('videoFile').value = '';
                document.getElementById('file-info').style.display = 'none';
            }
        });

        document.getElementById('add-recorded-class-form').addEventListener('submit', function(e) {
            e.preventDefault();

            const title = document.getElementById('title').value;
            const description = document.getElementById('description').value;
            const lecturer = document.getElementById('lecturer').value;
            const videoSrc = document.getElementById('videoSrc').value;
            const videoFile = document.getElementById('videoFile').files[0];

            // Validation - either URL or file must be provided
            if (!videoSrc.trim() && !videoFile) {
                alert('Please provide either a video URL or upload a video file.');
                return;
            }

            // File size validation (100MB limit)
            if (videoFile && videoFile.size > 100 * 1024 * 1024) {
                alert('File size must be less than 100MB.');
                return;
            }

            const recordedClass = {
                title,
                description,
                lecturer,
                videoSrc: videoSrc.trim(),
                fileName: videoFile ? videoFile.name : null,
                fileSize: videoFile ? videoFile.size : null,
                uploadDate: new Date().toISOString()
            };

            const recordedClasses = JSON.parse(localStorage.getItem('recordedClasses')) || [];
            recordedClasses.push(recordedClass);
            localStorage.setItem('recordedClasses', JSON.stringify(recordedClasses));

            alert('Recorded class added successfully!');
            this.reset();
            document.getElementById('file-info').style.display = 'none';
        });
    </script>
</body>
</html>
