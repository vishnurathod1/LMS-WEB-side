<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Add Recorded Class</title>
     <link rel="stylesheet" href="add_live_class.css" />
     <style>
        .add-recorded-class-page {
            background: linear-gradient(135deg, #abb6eb 0%, #764ba2 100%);
            min-height: 100vh;
        }
      #recorded-class-form{
        background-color: rgb(235, 219, 219);
      } 

        </style>
</head>
<body class="add-recorded-class-page">
    <nav class="navbar">
        <div class="navbar-container">
            <a href="home.html" class="navbar-brand">LMS Project</a>
            <ul class="navbar-menu">
                <li class="navbar-item"><a href="home.html" class="navbar-link">Home</a></li>
                <li class="navbar-item"><a href="student_home.html" class="navbar-link">Student Home</a></li>
                <li class="navbar-item"><a href="trainer_home.html" class="navbar-link">Trainer Home</a></li>
                <li class="navbar-item"><a href="login.html" class="navbar-link">Login</a></li>
                <li class="navbar-item"><a href="login.html" class="navbar-link">Logout</a></li>
            </ul>
        </div>
    </nav>
    <main class="add-recorded-class-main">
        <h1>Add Recorded Class</h1>
        <form id="recorded-class-form">
            <div class="form-group">
                <label for="title">Title:</label>
                <input type="text" id="title" required />
            </div>
            <div class="form-group">
                <label for="description">Description:</label>
                <textarea id="description" required></textarea>
            </div>
            <div class="form-group">
                <label for="video-url">Video URL:</label>
                <input type="url" id="video-url" placeholder="https://example.com/video.mp4" required />
            </div>
            <div class="form-group">
                <label for="course">Course:</label>
                <select id="course" required>
                    <option value="">Select Course</option>
                </select>
            </div>
            <div class="form-group">
                <label for="trainer">Trainer:</label>
                <input type="text" id="trainer" required />
            </div>
            <div class="form-group">
                <label for="status">Status:</label>
                <select id="status" required>
                    <option value="Active">Active</option>
                    <option value="Inactive">Inactive</option>
                </select>
            </div>
            <button type="submit" class="submit-btn">Add Recorded Class</button>
        </form>
    </main>
    <script>
        function getCourses() {
            const courses = localStorage.getItem('courses');
            return courses ? JSON.parse(courses) : [];
        }

        function getRecordedClasses() {
            const recordedClasses = localStorage.getItem('recordedClasses');
            return recordedClasses ? JSON.parse(recordedClasses) : [];
        }

        function saveRecordedClasses(recordedClasses) {
            localStorage.setItem('recordedClasses', JSON.stringify(recordedClasses));
        }

        function populateCourses() {
            const courses = getCourses();
            const courseSelect = document.getElementById('course');
            courses.forEach(course => {
                const option = document.createElement('option');
                option.value = course.title;
                option.textContent = course.title;
                courseSelect.appendChild(option);
            });
        }

        function getCurrentUser() {
            // Assuming current user is stored in localStorage as 'currentUser'
            const currentUser = localStorage.getItem('currentUser');
            return currentUser ? JSON.parse(currentUser) : null;
        }

        document.getElementById('recorded-class-form').addEventListener('submit', (e) => {
            e.preventDefault();
            const title = document.getElementById('title').value.trim();
            const description = document.getElementById('description').value.trim();
            const videoUrl = document.getElementById('video-url').value.trim();
            const course = document.getElementById('course').value;
            const trainer = document.getElementById('trainer').value.trim();
            const status = document.getElementById('status').value;

            if (!title || !description || !videoUrl || !course || !trainer) {
                alert('All fields are required.');
                return;
            }

            const recordedClasses = getRecordedClasses();
            // Prevent duplicate entries by checking if a class with the same title and course exists
            const duplicate = recordedClasses.some(rc => rc.title === title && rc.course === course);
            if (duplicate) {
                alert('This recorded class already exists for the selected course.');
                return;
            }

            recordedClasses.push({ title, description, videoUrl, course, trainer, status });
            saveRecordedClasses(recordedClasses);
            alert('Recorded class added successfully!');
            // Reset form
            document.getElementById('recorded-class-form').reset();
            // Redirect to recorded_lecturer.html to see the new class
            window.location.href = 'recorded_lecturer.html';
        });

        // Add delete button functionality on recorded_lecturer.html page
        // This script is added here for convenience; ideally, it should be in recorded_lecturer.html
        function addDeleteButtonListeners() {
            const deleteButtons = document.querySelectorAll('.delete-btn');
            deleteButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    const index = e.target.getAttribute('data-index');
                    const recordedClasses = getRecordedClasses();
                    recordedClasses.splice(index, 1);
                    saveRecordedClasses(recordedClasses);
                    alert('Recorded class deleted successfully!');
                    // Refresh the page or update UI accordingly
                    window.location.reload();
                });
            });
        }

        // Call the function to add delete button listeners
        addDeleteButtonListeners();
        });

        // Populate courses on load
        populateCourses();

        // Set trainer to current user if available
        const currentUser = getCurrentUser();
        if (currentUser) {
            document.getElementById('trainer').value = currentUser.name;
        }
    </script>
</body>
</html>
